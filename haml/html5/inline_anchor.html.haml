- case @type
- when :xref
  %a(href="##{@target}")<=(@text || @document.references[:ids].fetch(@target, "[#{@target}]")).tr_s("\n", ' ')
- when :ref
  %a(id=@target)
- when :bibref
  %a(id=@target)
  = surround '[', ']' do
    =@target
- else
  %a(href=@target){:class=>(attr :role), :target=>(attr :window)}=@text
